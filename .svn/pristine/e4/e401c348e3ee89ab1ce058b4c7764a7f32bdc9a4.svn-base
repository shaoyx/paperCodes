package org.apache.giraph.tools.benchmark;

import org.apache.commons.cli.CommandLine;
import org.apache.giraph.GiraphRunner;
import org.apache.giraph.benchmark.BenchmarkOption;
import org.apache.giraph.conf.GiraphConfiguration;
import org.apache.giraph.conf.GiraphConstants;
import org.apache.giraph.utils.ConfigurationUtils;
import org.apache.hadoop.util.ToolRunner;

public class BenchmarkEntry extends GiraphRunner {

	static{
		ConfigurationUtils.addOption("qpath", "querypath", true, "specify the file path of input path pattern");
	}
	
	 protected  void prepareConfiguration(GiraphConfiguration conf, CommandLine cmd) {
		String qpath = cmd.getOptionValue("qpath");
		
		GiraphConstants.INPUT_RAW_QUERY_PATH.set(conf, qpath);
		GiraphConstants.GRAPHOLAP_PATH_EVALUATION.set(conf, true);

		/* set the number of partitions equal to the number of workers. */
		GiraphConstants.USER_PARTITION_COUNT.set(conf, Integer.valueOf(BenchmarkOption.WORKERS.getOptionValue(cmd)));
	 }
	 
	 public static void main(String[] args) throws Exception {
		 System.exit(ToolRunner.run(new BenchmarkEntry(), args));
	}
}
